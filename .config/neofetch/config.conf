#!/usr/bin/env bash
# minimalist cyberpunk neofetch config

# source: ascii art style
print_info() {
    info title
    info underline
    
    # core system info - lowercase hacker vibe
    info "host" model
    info "os" distro  
    info "kernel" kernel
    info "uptime" uptime
    info "shell" shell
    info "term" term
    info "cpu" cpu
    info "memory" memory
    info "gpu" gpu
    info "resolution" resolution
    
    prin ""
    
    # custom integrations from sketchybar/startup scripts
    prin "$(tput setaf 8)// cyberdeck stats$(tput sgr0)"
    
    # typing speed from monkeytype api
    typing_stats=$(curl -s --max-time 2 "https://ejfox.com/api/monkeytype" 2>/dev/null | jq -r '.typingStats.bestWPM // "n/a"' 2>/dev/null || echo "n/a")
    prin "wpm" "$typing_stats"
    
    # active git repos with changes
    active_repos=$(find ~/code -maxdepth 1 -type d -exec test -d "{}/.git" \; -print | wc -l | tr -d ' ')
    modified_repos=$(find ~/code -maxdepth 1 -type d -exec sh -c 'cd "$1" && test -d .git && [ -n "$(git status --porcelain 2>/dev/null)" ]' _ {} \; -print | wc -l | tr -d ' ')
    prin "repos" "${modified_repos}/${active_repos} modified"
    
    # today's tasks count
    if command -v things-cli >/dev/null 2>&1; then
        task_count=$(things-cli today 2>/dev/null | wc -l | tr -d ' ' || echo "0")
        prin "tasks" "$task_count today"
    fi
    
    # word count from startup script
    word_count=$(curl -s --max-time 2 "https://ejfox.com/api/words/today" 2>/dev/null | jq -r '.count // "0"' 2>/dev/null || echo "0")
    prin "words" "$word_count today"
    
    # obsidian notes count
    obsidian_root="$HOME/Library/Mobile Documents/iCloud~md~obsidian/Documents/ejfox"
    if [ -d "$obsidian_root" ]; then
        note_count=$(find "$obsidian_root" -name "*.md" -not -path '*/\.*' | wc -l | tr -d ' ')
        prin "notes" "$note_count total"
    fi
    
    prin ""
    prin "$(tput setaf 8)// end transmission$(tput sgr0)"
}

# remove title
title_fqdn="off"

# kernel settings
kernel_shorthand="on"

# distro settings
distro_shorthand="off"

# os settings
os_arch="off"

# uptime settings
uptime_shorthand="on"

# memory settings
memory_percent="on"
memory_unit="gib"

# package settings
package_managers="on"

# shell settings
shell_path="off"
shell_version="on"

# cpu settings
speed_type="bios_limit"
speed_shorthand="on"
cpu_brand="off"
cpu_speed="off"
cpu_cores="logical"
cpu_temp="off"

# gpu settings
gpu_brand="off"
gpu_type="all"

# resolution settings
refresh_rate="on"

# color blocks
block_range=(0 15)
block_width=3
block_height=1

# colors
colors=(8 15 7 1 3 4 5 6 2)

# text options
bold="off"
underline_enabled="on"
underline_char="─"
separator=" ❯ "

# color blocks
color_blocks="off"

# progress bars
bar_char_elapsed="━"
bar_char_total="─"
bar_border="off"
bar_length=15
bar_color_elapsed="7"
bar_color_total="8"

# backend settings
image_backend="ascii"
image_source="🍎

  ┌───────────┐
  │           │
  │  🍎       │
  │           │
  │           │
  │           │
  │           │
  │           │
  └───────────┘"

# ascii settings
ascii_distro="custom"
ascii_colors=(8 7)
ascii_bold="off"

# image settings
crop_mode="normal"
crop_offset="center"

# gap settings
gap=2

# misc options
stdout="off"